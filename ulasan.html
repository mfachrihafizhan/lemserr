<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ulasan Pelanggan - Lemon Sereh</title>
  <link rel="stylesheet" href="style.css">
</head>

<!-- Customer Service -->
<div id="cs-popup" class="cs-popup">
  <a href="https://wa.me/6282112291916" target="_blank" class="cs-popup-btn">
    ğŸŸ¢CS
  </a>
</div>

<body>
  <!-- Hamburger -->
  <div id="sidebarToggle" class="sidebar-hamburger">
    <svg width="40" height="40" viewBox="0 0 40 40">
      <rect y="9" width="32" height="5" rx="2.2" fill="#454545"/>
      <rect y="19" width="32" height="5" rx="2.2" fill="#454545"/>
      <rect y="29" width="32" height="5" rx="2.2" fill="#454545"/>
    </svg>
  </div>

  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar">
    <div class="sidebar-pen"></div>
    <nav class="sidebar-menu">
      <a href="index.html" class="sidebar-link">
        <span class="sidebar-icon">ğŸ </span><span class="sidebar-text">Profil</span>
      </a>
      <a href="tentang.html" class="sidebar-link">
        <span class="sidebar-icon">â„¹ï¸</span><span class="sidebar-text">Tentang</span>
      </a>
      <a href="produk.html" class="sidebar-link">
        <span class="sidebar-icon">ğŸ›’</span><span class="sidebar-text">Produk</span>
      </a>
      <a href="order.html" class="sidebar-link">
        <span class="sidebar-icon">ğŸ“</span><span class="sidebar-text">Order</span>
      </a>
      <a href="ulasan.html" class="sidebar-link">
        <span class="sidebar-icon">â­</span><span class="sidebar-text">Ulasan</span>
      </a>

      <a href="auth.html" id="btn-login-open" class="sidebar-link">
        <span class="sidebar-icon">ğŸ”‘</span><span class="sidebar-text">Login</span>
      </a>
      <a href="#" id="btn-logout" class="sidebar-link" style="display:none;">
        <span class="sidebar-icon">ğŸšª</span><span class="sidebar-text">Logout</span>
      </a>
      <a href="profil.html" id="btn-profil" class="sidebar-link" style="display:none;">
        <span class="sidebar-icon">ğŸ‘¤</span><span class="sidebar-text">Profil</span>
      </a>
    </nav>
  </aside>

  <main class="card produk-main">
    <h2 style="color:#705900;">Ulasan Pelanggan</h2>

    <!-- SUMMARY RATING -->
    <section class="ulasan-summary">
      <div class="ulasan-summary-left">
        <h3>Rating Terbaru</h3>

        <div class="ulasan-bar-row">
          <span>5â˜…</span>
          <div class="ulasan-bar"><div class="ulasan-bar-fill" id="bar-5"></div></div>
          <span id="count-5">0</span>
        </div>
        <div class="ulasan-bar-row">
          <span>4â˜…</span>
          <div class="ulasan-bar"><div class="ulasan-bar-fill" id="bar-4"></div></div>
          <span id="count-4">0</span>
        </div>
        <div class="ulasan-bar-row">
          <span>3â˜…</span>
          <div class="ulasan-bar"><div class="ulasan-bar-fill" id="bar-3"></div></div>
          <span id="count-3">0</span>
        </div>
        <div class="ulasan-bar-row">
          <span>2â˜…</span>
          <div class="ulasan-bar"><div class="ulasan-bar-fill" id="bar-2"></div></div>
          <span id="count-2">0</span>
        </div>
        <div class="ulasan-bar-row">
          <span>1â˜…</span>
          <div class="ulasan-bar"><div class="ulasan-bar-fill" id="bar-1"></div></div>
          <span id="count-1">0</span>
        </div>
      </div>

      <div class="ulasan-summary-right">
        <div id="avg-rating" class="ulasan-avg">0.0</div>
        <div class="ulasan-stars" id="avg-stars">â˜…â˜…â˜…â˜…â˜…</div>
        <div id="total-reviews" class="ulasan-total">0 reviews</div>
      </div>
    </section>

    <!-- FILTER PRODUK -->
    <div class="ulasan-filter">
      <label for="filterProduk">Filter produk:</label>
      <select id="filterProduk">
        <option value="all">Semua produk</option>
        <option value="large">Lemon Sereh - Cup Large</option>
        <option value="medium">Lemon Sereh - Cup Medium</option>
        <option value="small">Lemon Sereh - Cup Small</option>
      </select>
    </div>

    <!-- FORM TULIS ULASAN -->
    <section class="ulasan-add">
      <h3>Tulis Ulasan</h3>
      <form id="form-ulasan-global">
        <select id="ulasan-produk" required>
          <option value="">Pilih produk</option>
          <option value="large">Lemon Sereh - Cup Large</option>
          <option value="medium">Lemon Sereh - Cup Medium</option>
          <option value="small">Lemon Sereh - Cup Small</option>
        </select>
        <select id="ulasan-rating" required>
          <option value="">Pilih rating</option>
          <option value="5">5 - Mantap</option>
          <option value="4">4 - Enak</option>
          <option value="3">3 - Cukup</option>
          <option value="2">2 - Kurang</option>
          <option value="1">1 - Buruk</option>
        </select>
        <textarea id="ulasan-text" placeholder="Tulis ulasan kamu..." required></textarea>
        <button type="submit" class="profil-btn">Kirim Ulasan</button>
      </form>
    </section>

    <!-- LIST ULASAN -->
    <div id="ulasan-list" class="ulasan-list">
      <!-- diisi dari app.js -->
    </div>
  </main>

  <script>
    // SIDEBAR
    const sidebar = document.getElementById("sidebar");
    const toggleBtn = document.getElementById("sidebarToggle");
    toggleBtn.onclick = function(e) {
      sidebar.classList.toggle("active");
      e.stopPropagation();
    };
    document.addEventListener("click", function(e) {
      if(window.innerWidth <= 600 &&
         !sidebar.contains(e.target) &&
         !toggleBtn.contains(e.target)) {
        sidebar.classList.remove("active");
      }
    });

    // FORM ULASAN GLOBAL: pakai fungsi addReview di app.js
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('form-ulasan-global');
      if (!form) return;

      form.addEventListener('submit', e => {
        e.preventDefault();
        const produkId = document.getElementById('ulasan-produk').value;
        const rating = document.getElementById('ulasan-rating').value;
        const text = document.getElementById('ulasan-text').value;
        if (!produkId || !rating || !text.trim()) return;

        // pakai addReview milik app.js
        if (typeof addReview === 'function') {
          addReview(produkId, rating, text);
        } else {
          alert('Fungsi ulasan belum tersedia.');
        }

        form.reset();
      });
    });
  </script>

  <script src="app.js"></script>
</body>
</html>